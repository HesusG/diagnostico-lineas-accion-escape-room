<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La MisiÃ³n del Conde Donador - Escape Room</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Pantalla de Login -->
    <div id="login-screen" class="screen">
        <div class="login-content">
            <h1>ğŸ”’ ACCESO RESTRINGIDO</h1>
            <p>Ingrese cÃ³digo de autorizaciÃ³n de la FundaciÃ³n</p>
            <div class="input-group">
                <input type="password" id="password-input" placeholder="CÃ³digo de acceso" autocomplete="off">
                <button id="login-btn" class="btn-primary">ACCEDER</button>
            </div>
            <p id="login-error" class="error-msg hidden">â›” CÃ³digo incorrecto</p>
        </div>
    </div>

    <!-- Pantalla de SelecciÃ³n de Personaje -->
    <div id="character-select-screen" class="screen hidden">
        <div class="character-select-content">
            <h1>Crea tu Analista</h1>
            <p class="subtitle">Elige tu avatar y escribe tu nombre</p>

            <div class="character-options">
                <div class="character-option selected" data-gender="male">
                    <img src="images/player/personaje_hombre.png" alt="Personaje Masculino">
                    <span>Analista</span>
                </div>
                <div class="character-option" data-gender="female">
                    <img src="images/player/personaje_mujer.png" alt="Personaje Femenino">
                    <span>Analista</span>
                </div>
            </div>

            <div class="name-input-container">
                <label for="player-name">Tu nombre:</label>
                <input type="text" id="player-name" placeholder="Escribe tu nombre" maxlength="20" autocomplete="off">
            </div>

            <button id="confirm-character-btn" class="btn-primary">Confirmar</button>
        </div>
    </div>

    <!-- Pantalla de Inicio -->
    <div id="start-screen" class="screen hidden">
        <div class="start-content-wide">
            <div class="start-left">
                <h1>La MisiÃ³n del Conde Donador</h1>
                <button id="start-btn" class="btn-primary btn-large">ğŸš€ Comenzar MisiÃ³n</button>
                <div class="resolution-help">
                    <p>ğŸ’¡ <strong>Tip:</strong> Si no ves bien el juego completo, usa el botÃ³n ğŸ–¥ï¸ en la esquina
                        superior derecha durante el juego.</p>
                </div>
                <div class="narrative">
                    <p>El <strong>Conde Von Donativo</strong> es el mayor benefactor de FundaciÃ³n TeletÃ³n.</p>
                    <p>Tiene una reuniÃ³n con su junta directiva en <strong>30 minutos</strong> y necesita un
                        <strong>reporte
                            ejecutivo con evidencia sÃ³lida</strong> para aprobar una donaciÃ³n de $10 millones de pesos.
                    </p>
                    <p>Eres un <strong>analista de datos</strong> que debe recorrer la mansiÃ³n recolectando la evidencia
                        correcta:</p>
                    <ul>
                        <li>ğŸ“Š EstadÃ­sticas descriptivas</li>
                        <li>ğŸ“ˆ Pruebas de hipÃ³tesis</li>
                        <li>ğŸ“‹ AnÃ¡lisis estratÃ©gico (FODA/PESTEL)</li>
                        <li>ğŸ¯ KPIs y mÃ©tricas</li>
                        <li>ğŸ“‰ Visualizaciones efectivas</li>
                    </ul>
                    <p class="warning">âš ï¸ Â¡CUIDADO! No todo lo que brilla es oro. Hay documentos con errores que harÃ­an
                        quedar mal al Conde.</p>
                </div>
                <div class="controls-info">
                    <h3>Controles</h3>
                    <p><kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> o
                        <kbd>â†‘</kbd><kbd>â†</kbd><kbd>â†“</kbd><kbd>â†’</kbd> -
                        Mover
                    </p>
                    <p><kbd>H</kbd> - Ocultar/Mostrar Minimapa</p>
                    <p>AcÃ©rcate a NPCs y objetos para interactuar automÃ¡ticamente</p>
                </div>
                <div class="best-time" id="best-time-display"></div>
            </div>
            <div class="start-right">
                <div class="start-image-placeholder">
                    <img src="images/ui/conde_start.png" alt="Conde Von Donativo"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="image-placeholder-text">
                        <span>ğŸ°</span>
                        <p>Imagen del Conde</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Juego -->
    <div id="game-screen" class="screen hidden">
        <!-- HUD Superior -->
        <div id="hud">
            <div class="hud-left">
                <span id="timer">â° 30:00</span>
            </div>
            <div class="hud-center">
                <span id="location">ğŸ“ Gran VestÃ­bulo</span>
            </div>
            <div class="hud-right">
                <span id="evidence-count">ğŸ“¦ 0/8</span>
                <span id="error-count">âš ï¸ 0/3</span>
                <button id="resolution-btn" class="btn-icon" title="Cambiar ResoluciÃ³n">ğŸ–¥ï¸</button>
                <button id="mute-btn" class="btn-icon">ğŸ”Š</button>
            </div>
        </div>

        <!-- Hint de NavegaciÃ³n -->
        <div id="navigation-hint">
            <span id="nav-hint-text">ğŸ¯ Ve al Pasillo Central</span>
        </div>

        <!-- Minimap -->
        <div id="minimap-container">
            <div id="minimap">
                <!-- Minimap content generated by JS -->
            </div>
            <div id="minimap-label">MAPA</div>
        </div>

        <!-- Ãrea de Juego -->
        <div id="game-container">
            <div id="room">
                <!-- Objetos de la habitaciÃ³n se generan dinÃ¡micamente -->
            </div>
            <div id="player">
                <img id="player-sprite" src="images/player/personaje_hombre.png" alt="Player"
                    onerror="this.style.display='none'; this.parentElement.querySelector('.player-emoji').style.display='block';">
                <span class="player-emoji" style="display:none;">ğŸ§‘â€ğŸ’¼</span>
            </div>
        </div>

        <!-- Inventario -->
        <div id="inventory">
            <h3>ğŸ“‹ Evidencias Recolectadas</h3>
            <div id="inventory-items">
                <!-- Items se agregan dinÃ¡micamente -->
            </div>
        </div>
    </div>

    <!-- Modal de InteracciÃ³n -->
    <div id="interaction-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span id="modal-icon">ğŸ“„</span>
                <h2 id="modal-title">Documento</h2>
            </div>
            <div id="modal-body">
                <!-- Contenido del documento -->
            </div>
            <div class="modal-actions">
                <button id="btn-collect" class="btn-success">âœ“ Recoger</button>
                <button id="btn-leave" class="btn-secondary">âœ— Dejar</button>
            </div>
        </div>
    </div>

    <!-- Modal de DiÃ¡logo NPC -->
    <div id="dialog-modal" class="modal hidden">
        <div class="modal-content dialog-box">
            <div class="npc-header">
                <span id="npc-icon">ğŸ¤µ</span>
                <span id="npc-name">Mayordomo</span>
            </div>
            <p id="dialog-text"></p>
            <div class="dialog-buttons">
                <button id="btn-next-dialog" class="btn-primary hidden">Siguiente â†’</button>
                <button id="btn-close-dialog" class="btn-secondary">Continuar</button>
            </div>
            <div id="dialog-page-indicator" class="hidden">1/3</div>
        </div>
    </div>

    <!-- Modal de Feedback -->
    <div id="feedback-modal" class="modal hidden">
        <div class="modal-content feedback-box">
            <span id="feedback-icon">âœ“</span>
            <p id="feedback-text"></p>
        </div>
    </div>

    <!-- Pantalla de Victoria -->
    <div id="victory-screen" class="screen hidden">
        <div class="end-content victory">
            <h1>ğŸ† Â¡MISIÃ“N CUMPLIDA!</h1>
            <div class="conde-message">
                <span class="conde-icon">ğŸ§›</span>
                <div class="speech-bubble">
                    <p><strong>CONDE VON DONATIVO:</strong></p>
                    <p>"Â¡Extraordinario! Este reporte tiene:</p>
                    <ul>
                        <li>âœ“ Datos descriptivos sÃ³lidos</li>
                        <li>âœ“ Pruebas estadÃ­sticas rigurosas</li>
                        <li>âœ“ AnÃ¡lisis estratÃ©gico fundamentado</li>
                        <li>âœ“ Visualizaciones que comunican</li>
                    </ul>
                    <p>La junta aprobÃ³ los <strong>$10 millones</strong>.</p>
                    <p>Â¡TeletÃ³n recibirÃ¡ la donaciÃ³n!"</p>
                </div>
            </div>
            <div class="stats">
                <p>â±ï¸ Tiempo: <span id="final-time">--:--</span></p>
                <p>âš ï¸ Errores: <span id="final-errors">0</span>/3</p>
            </div>
            <button id="play-again-victory" class="btn-primary">ğŸ”„ Jugar de Nuevo</button>
        </div>
    </div>

    <!-- Pantalla de Derrota por Tiempo -->
    <div id="defeat-time-screen" class="screen hidden">
        <div class="end-content defeat">
            <h1>ğŸ’€ GAME OVER</h1>
            <div class="conde-message">
                <span class="conde-icon">ğŸ§›</span>
                <div class="speech-bubble">
                    <p><strong>CONDE VON DONATIVO:</strong></p>
                    <p>"La junta se fue. Sin evidencia a tiempo, no hay donaciÃ³n.</p>
                    <p>Los niÃ±os de TeletÃ³n tendrÃ¡n que esperar otro aÃ±o para ese equipo de rehabilitaciÃ³n..."</p>
                </div>
            </div>
            <button id="play-again-time" class="btn-primary">ğŸ”„ Intentar de Nuevo</button>
        </div>
    </div>

    <!-- Pantalla de Derrota por Errores -->
    <div id="defeat-errors-screen" class="screen hidden">
        <div class="end-content defeat">
            <h1>ğŸ’€ GAME OVER</h1>
            <div class="conde-message">
                <span class="conde-icon">ğŸ§›</span>
                <div class="speech-bubble">
                    <p><strong>CONDE VON DONATIVO:</strong></p>
                    <p>"Â¿GrÃ¡ficos 3D? Â¿Rumores sin fuente? Â¿CorrelaciÃ³n confundida con causa?</p>
                    <p>La junta perdiÃ³ la confianza en el anÃ¡lisis.</p>
                    <p>La donaciÃ³n ha sido <strong>CANCELADA</strong>."</p>
                </div>
            </div>
            <button id="play-again-errors" class="btn-primary">ğŸ”„ Intentar de Nuevo</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/data.js?v=4"></script>
    <script src="js/audio.js?v=4"></script>
    <script src="js/dialog.js?v=6"></script>
    <script src="js/inventory.js?v=6"></script>
    <script src="js/timer.js?v=6"></script>
    <script src="js/minimap.js?v=6"></script>
    <script src="js/navigation.js?v=7"></script>
    <script src="js/rooms.js?v=7"></script>
    <script src="js/player.js?v=7"></script>
    <script src="js/game.js?v=7"></script>
    <script src="js/dev_tools.js"></script>
    <div id="dev-mode-indicator"
        style="position: fixed; top: 0; left: 0; background: red; color: white; padding: 5px; z-index: 9999; font-weight: bold;">
        DEV MODE</div>
</body>

</html>